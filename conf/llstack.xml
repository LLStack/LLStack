<?xml version="1.0" encoding="UTF-8"?>
<virtualHostTemplate>
  <vhRoot>/var/www/vhosts/$VH_NAME/</vhRoot>
  <configFile>$SERVER_ROOT/conf/$VH_NAME.xml</configFile>
  <allowSymbolLink>1</allowSymbolLink>
  <enableScript>1</enableScript>
  <restrained>1</restrained>
  <setUIDMode>2</setUIDMode>
  <chrootMode>0</chrootMode>
  <virtualHostConfig>
    <docRoot>$VH_ROOT/html/</docRoot>
    <enableGzip>1</enableGzip>
    <logging>
      <log>
        <useServer>1</useServer>
      </log>
      <accessLog>
        <useServer>0</useServer>
        <fileName>$SERVER_ROOT/logs/$VH_NAME.access.log</fileName>
        <rollingSize>100M</rollingSize>
        <keepDays>7</keepDays>
        <compressArchive>1</compressArchive>
      </accessLog>
    </logging>
    <index>
      <useServer>0</useServer>
      <indexFiles>index.html, index.php</indexFiles>
      <autoIndex>0</autoIndex>
      <autoIndexURI>/_autoindex/default.php</autoIndexURI>
    </index>
    <scriptHandlerList>
      <scriptHandler>
        <suffix>php</suffix>
        <type>lsapi</type>
        <handler>$VH_NAME_lsphp</handler>
      </scriptHandler>
    </scriptHandlerList>
    <htAccess>
      <allowOverride>31</allowOverride>
      <accessFileName>.htaccess</accessFileName>
    </htAccess>
    <expires>
      <enableExpires>1</enableExpires>
    </expires>
    <security>
      <hotlinkCtrl>
        <enableHotlinkCtrl>0</enableHotlinkCtrl>
        <suffixes>gif, jpeg, jpg</suffixes>
        <allowDirectAccess>1</allowDirectAccess>
        <onlySelf>1</onlySelf>
      </hotlinkCtrl>
      <accessControl>
        <allow>*</allow>
      </accessControl>
    </security>
    <cache>
      <cacheEngine>7</cacheEngine>
      <storage>
        <cacheStorePath>/var/www/vhosts/lscache/</cacheStorePath>
        <litemage>1</litemage>
      </storage>
      <cachePolicy>
        <checkPublicCache>1</checkPublicCache>
      </cachePolicy>
    </cache>
    <extProcessorList>
      <extProcessor>
        <type>lsapi</type>
        <name>$VH_NAME_lsphp</name>
        <address>uds://tmp/lshttpd/$VH_NAME_lsphp.sock</address>
        <maxConns>35</maxConns>
        <env>PHP_LSAPI_CHILDREN=35</env>
        <initTimeout>60</initTimeout>
        <retryTimeout>0</retryTimeout>
        <respBuffer>0</respBuffer>
        <autoStart>1</autoStart>
        <path>/usr/local/lsws/lsphp74/bin/lsphp</path>
        <backlog>100</backlog>
        <instances>1</instances>
        <extMaxIdleTime>-1</extMaxIdleTime>
        <priority>0</priority>
        <memSoftLimit>2047M</memSoftLimit>
        <memHardLimit>2047M</memHardLimit>
        <procSoftLimit>3000</procSoftLimit>
        <procHardLimit>4000</procHardLimit>
      </extProcessor>
    </extProcessorList>
    <rewrite>
      <enable>1</enable>
      <logLevel>0</logLevel>
      <rules>
RewriteCond %{HTTP_USER_AGENT}  ^NameOfBadRobot
  RewriteRule ^/nospider/         -   [F]
      </rules>
    </rewrite>
    <vhssl>
      <keyFile>/root/.acme.sh/certs/$VH_NAME/$VH_NAME.key</keyFile>
      <certFile>/root/.acme.sh/certs/$VH_NAME/fullchain.cer</certFile>
      <certChain>1</certChain>
    </vhssl>
    <frontPage>
      <enable>0</enable>
      <disableAdmin>0</disableAdmin>
    </frontPage>
    <awstats>
      <updateMode>0</updateMode>
      <workingDir>$VH_ROOT/awstats</workingDir>
      <awstatsURI>/awstats/</awstatsURI>
      <siteDomain>localhost</siteDomain>
      <siteAliases>127.0.0.1 localhost</siteAliases>
      <updateInterval>86400</updateInterval>
      <updateOffset>0</updateOffset>
    </awstats>
  </virtualHostConfig>
</virtualHostTemplate>
